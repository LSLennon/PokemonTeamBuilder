@page "/DatabaseBuilder"
@inject PokemonApiService PokeApi
@inject PokemonServices PokeServices

<MudButton Variant="Variant.Filled"
           Color="Color.Primary"
           Class="ml-auto"
           OnClick="AddTypes">
    Add Types
</MudButton>

<MudSpacer />

<MudButton Variant="Variant.Filled"
           Color="Color.Primary"
           Class="ml-auto"
           OnClick="AddTypeEffectivness">
    Add Type Effectivness
</MudButton>

<MudSpacer />

<MudButton Variant="Variant.Filled"
           Color="Color.Primary"
           Class="ml-auto"
           OnClick="AddNextPokemon">
    Add Next Pokemon
</MudButton>

@code {
    private async Task AddTypes()
    {
        List<PokeType> TypesBeingAdded = await PokeApi.AddTypeNames();
        await PokeServices.AddTypeAsync(TypesBeingAdded);
    }

    private async Task AddTypeEffectivness()
    {
        List<PokeType> allTypes =  await PokeServices.GetTypeList();
        List<TypeEffectiveness> typeEffectivenesses = await PokeApi.GetEffectiveness(allTypes);
        foreach(var i in typeEffectivenesses)
        {
            await PokeServices.AddTypeEffectivness(i);
        }
    }

    public async Task AddNextPokemon()
    {
        List<PokeType> allTypes = await PokeServices.GetTypeList();
        for(int i = 1; i <= 1024; i++)
        {
            await PokeServices.AddPokemon(await PokeApi.GetPokemonForDatabase(i, allTypes));
        }
    }
}
